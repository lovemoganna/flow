
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Batch Script &#8212; Revolt&#39;s NoteBook</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/assets/css/website.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="../../_static/assets/js/website.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Batch Script" href="init-batch-mode-three.html" />
    <link rel="prev" title="Batch Script" href="init-batch-mode.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Revolt's NoteBook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   Sphinx Books Archives
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  测试模板:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../usage.html">
   reStructedText 文档风格指南
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Sphinx集成:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../sphinx-doc/index.html">
   Sphinx模板、插件
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../sphinx-doc/useage.html">
     Sphinx小节测试
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../sphinx-doc/ox-rst.html">
     Org Mode导出 Rst 文档后端测试
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../sphinx-doc/ox-rst-en.html">
     reStructuredText后端导出原始文档
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Emacs major mode:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   Emacs 文档
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="init-batch-mode.html">
     Batch Script
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Batch Script
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="init-batch-mode-three.html">
     Batch Script
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Emacs/system-coding.html">
     Emacs Coding System
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Makefile-mode/init-makefile-mode.html">
     Makefile mode
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Windows下的所有应用:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Windows/index.html">
   Windows 技巧
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Windows/bug.n/init-bugn.html">
     1 Bug.n
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Windows/captura/init-captura.html">
     1 Captura-cli
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Windows/autohotkey/init-autohot-key.html">
     1 Autohotkey
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Emacs/Batch-mode/init-batch-mode-two.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/lovemoganna/revolt-theme"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/lovemoganna/revolt-theme/issues/new?title=Issue%20on%20page%20%2FEmacs/Batch-mode/init-batch-mode-two.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/lovemoganna/revolt-theme/edit/master/Emacs/Batch-mode/init-batch-mode-two.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> 目录
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   任务
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     基本参数
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     公用头
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notepad">
     某个时间打开notepad
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s1">
     每2S运行1个任务
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       问题和解决方式
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     中止计划
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     删除任务
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     按照某段时间查询计划
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       打印为列表
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       查询
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#emacs-batch">
   Emacs Batch 集成环境设置
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cmd">
     直接绑定 CMD 固定目录终端
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     有用的环境变量
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     设置永久变量
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     追加路径
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       将某个目录添加环境变量中
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     不打开文件或用户对话框
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     追加环境变量
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     查找文件
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id18">
     异步执行命令
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id19">
     复制命令输出至剪切板
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cmd-eshell">
     Cmd 命令和 Eshell 命令混合使用
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#powershell">
     直接运行 PowerShell 终端
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bat">
     Bat 示例
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id20">
   记录错误级别日志
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="batch-script">
<h1><a class="toc-backref" href="#id21">Batch Script</a><a class="headerlink" href="#batch-script" title="永久链接至标题">¶</a></h1>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Revolt</p>
</dd>
<dt class="field-even">Date</dt>
<dd class="field-even"><p>&lt;2021-07-24 Sat 17:30&gt;</p>
</dd>
</dl>
</div></blockquote>
<div class="contents topic" id="id1">
<p class="topic-title">目录</p>
<ul class="simple">
<li><p><a class="reference internal" href="#batch-script" id="id21">Batch Script</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id22">任务</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id23">基本参数</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id24">公用头</a></p></li>
<li><p><a class="reference internal" href="#notepad" id="id25">某个时间打开notepad</a></p></li>
<li><p><a class="reference internal" href="#s1" id="id26">每2S运行1个任务</a></p>
<ul>
<li><p><a class="reference internal" href="#id5" id="id27">问题和解决方式</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id6" id="id28">中止计划</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id29">删除任务</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id30">按照某段时间查询计划</a></p>
<ul>
<li><p><a class="reference internal" href="#id9" id="id31">打印为列表</a></p></li>
<li><p><a class="reference internal" href="#id10" id="id32">查询</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#emacs-batch" id="id33">Emacs Batch 集成环境设置</a></p>
<ul>
<li><p><a class="reference internal" href="#cmd" id="id34">直接绑定 CMD 固定目录终端</a></p></li>
<li><p><a class="reference internal" href="#id11" id="id35">有用的环境变量</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id36">设置永久变量</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id37">追加路径</a></p>
<ul>
<li><p><a class="reference internal" href="#id14" id="id38">将某个目录添加环境变量中</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id15" id="id39">不打开文件或用户对话框</a></p></li>
<li><p><a class="reference internal" href="#id16" id="id40">追加环境变量</a></p></li>
<li><p><a class="reference internal" href="#id17" id="id41">查找文件</a></p></li>
<li><p><a class="reference internal" href="#id18" id="id42">异步执行命令</a></p></li>
<li><p><a class="reference internal" href="#id19" id="id43">复制命令输出至剪切板</a></p></li>
<li><p><a class="reference internal" href="#cmd-eshell" id="id44">Cmd 命令和 Eshell 命令混合使用</a></p></li>
<li><p><a class="reference internal" href="#powershell" id="id45">直接运行 PowerShell 终端</a></p></li>
<li><p><a class="reference internal" href="#bat" id="id46">Bat 示例</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id20" id="id47">记录错误级别日志</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id22">任务</a><a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id23">基本参数</a><a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<div class="highlight-org notranslate"><div class="highlight"><pre><span></span>SCHTASKS /Create [/S system [/U username [/P [password]]]]
[/RU username [/RP password]] /SC schedule [/MO modifier] [/D day]
[/M months] [/I idletime] /TN taskname /TR taskrun [/ST starttime]
[/RI interval] [ {/ET endtime | /DU duration} [/K] [/XML xmlfile] [/V1]]
[/SD startdate] [/ED enddate] [/IT | /NP] [/Z] [/F] [/HRESULT] [/?]

描述: 允许管理员在本地或远程系统上创建计划任务。

参数列表:

/S   system        指定要连接到的远程系统。如果省略这个系统参数，默认是本地系统。

/U   username      指定应在其中执行 SchTasks.exe 的用户上下文。

/P   [password]    指定给定用户上下文的密码。如果省略则 提示输入。

/RU  username      指定任务在其下运行的“运行方式”用户 帐户(用户上下文)。对于系统帐户，有效 值是 &quot;&quot;、&quot;NT AUTHORITY\SYSTEM&quot; 或 &quot;SYSTEM&quot;。 对于 v2 任务，&quot;NT AUTHORITY\LOCALSERVICE&quot;和 &quot;NT AUTHORITY\NETWORKSERVICE&quot;以及常见的 SID 对这三个也都可用。

/RP  [password]    指定“运行方式”用户的密码。要提示输 入密码，值必须是 &quot;*&quot; 或无。系统帐户会忽略该 密码。必须和 /RU 或 /XML 开关一起使用。

/RU/XML    /SC   schedule     指定计划频率。 有效计划任务:  MINUTE、 HOURLY、DAILY、WEEKLY、 MONTHLY, ONCE, ONSTART, ONLOGON, ONIDLE, ONEVENT.

/MO   modifier     改进计划类型以允许更好地控制计划重复 周期。有效值列于下面“修改者”部分中。

/D    days         指定该周内运行任务的日期。有效值: MON、TUE、WED、THU、FRI、SAT、SUN 和对 MONTHLY 计划的 1 - 31 (某月中的日期)。通配符“*”指定所有日期。

/M    months       指定一年内的某月。默认是该月的第一天。 有效值: JAN、FEB、MAR、APR、MAY、JUN、 JUL、 AUG、SEP、OCT、NOV  和 DEC。通配符 “*” 指定所有的月。

/I    idletime     指定运行一个已计划的 ONIDLE 任务之前 要等待的空闲时间。 有效值范围: 1 到 999 分钟。

/TN   taskname     以路径\名称形式指定 对此计划任务进行唯一标识的字符串。

/TR   taskrun      指定在这个计划时间运行的程序的路径 和文件名。 例如: C:\windows\system32\calc.exe

/ST   starttime    指定运行任务的开始时间。 时间格式为 HH:mm (24 小时时间)，例如 14:30 表示 2:30 PM。如果未指定 /ST，则默认值为 当前时间。/SC ONCE 必需有此选项。
/RI   interval     用分钟指定重复间隔。这不适用于 计划类型: MINUTE、HOURLY、 ONSTART, ONLOGON, ONIDLE, ONEVENT. 有效范围: 1 - 599940 分钟。 如果已指定 /ET 或 /DU，则其默认值为 10 分钟。

/ET   endtime      指定运行任务的结束时间。 时间格式为 HH:mm (24 小时时间)，例如，14:50 表示 2:50 PM。 这不适用于计划类型: ONSTART、 ONLOGON, ONIDLE, ONEVENT.

/DU   duration     指定运行任务的持续时间。 时间格式为 HH:mm。这不适用于 /ET 和 计划类型: ONSTART, ONLOGON, ONIDLE, ONEVENT. 对于 /V1 任务，如果已指定 /RI，则持续时间默认值为 1 小时。

/K                 在结束时间或持续时间终止任务。 这不适用于计划类型: ONSTART、 ONLOGON, ONIDLE, ONEVENT. 必须指定 /ET 或 /DU。

/SD   startdate    指定运行任务的第一个日期。 格式为 yyyy/mm/dd。默认值为 当前日期。这不适用于计划类型: ONCE、 ONSTART, ONLOGON, ONIDLE, ONEVENT.

/ED   enddate      指定此任务运行的最后一天的日期。 格式是 yyyy/mm/dd。这不适用于计划类型: ONCE、ONSTART、ONLOGON、ONIDLE。

/EC   ChannelName  为 OnEvent 触发器指定事件通道。

/IT                仅有在 /RU 用户当前已登录且 作业正在运行时才可以交互式运行任务。 此任务只有在用户已登录的情况下才运行。

/NP                不储存任何密码。任务以给定用户的身份 非交互的方式运行。只有本地资源可用。

/Z                 标记在最终运行完任务后删除任务。

/XML  xmlfile      从文件的指定任务 XML 中创建任务。 可以组合使用 /RU 和 /RP 开关，或者在任务 XML 已包含 主体时单独使用 /RP。

/V1                创建 Vista 以前的平台可以看见的任务。 不兼容 /XML。

/F                 如果指定的任务已经存在，则强制创建 任务并抑制警告。

/RL   level        为作业设置运行级别。有效值为 LIMITED 和 HIGHEST。默认值为 LIMITED。

/DELAY delaytime   指定触发触发器后延迟任务运行的 等待时间。时间格式为 mmmm:ss。此选项仅对计划类型 ONSTART, ONLOGON, ONEVENT.

/HRESULT          为获得更出色的故障诊断能力，处理退出代码 将采用 HRESULT 格式。

/?                 显示此帮助消息。

修改者: 按计划类型的 /MO 开关的有效值:
MINUTE:  1 到 1439 分钟。
HOURLY:  1 - 23 小时。
DAILY:   1 到 365 天。
WEEKLY:  1 到 52 周。
ONCE:    无修改者。
ONSTART: 无修改者。
ONLOGON: 无修改者。
ONIDLE:  无修改者。
MONTHLY: 1 到 12，或 FIRST, SECOND, THIRD, FOURTH, LAST, LASTDAY。

ONEVENT:  XPath 事件查询字符串。 示例:

==&gt; 在远程机器 &quot;ABC&quot; 上创建计划任务 &quot;doc&quot;， 该机器每小时在 &quot;runasuser&quot; 用户下运行 notepad.exe。

SCHTASKS /Create /S ABC /U user /P password /RU runasuser /RP runaspassword
/SC HOURLY /TN doc /TR notepad

==&gt; 在远程机器 &quot;ABC&quot; 上创建计划任务 &quot;accountant&quot;， 在指定的开始日期和结束日期之间的开始时间和结束时间内， 每隔五分钟运行 calc.exe。

SCHTASKS /Create /S ABC /U domain\user /P password /SC MINUTE
/MO 5 /TN accountant /TR calc.exe /ST 12:00 /ET 14:00
/SD 06/06/2006 /ED 06/06/2006 /RU runasuser /RP userpassword

==&gt; 创建计划任务 &quot;gametime&quot;，在每月的第一个星期天 运行“空当接龙”。

SCHTASKS /Create /SC MONTHLY /MO first /D SUN /TN gametime
/TR c:\windows\system32\freecell

==&gt; 在远程机器 &quot;ABC&quot; 创建计划任务 &quot;report&quot;， 每个星期运行 notepad.exe。

SCHTASKS /Create /S ABC /U user /P password /RU runasuser
/RP runaspassword /SC WEEKLY /TN report /TR notepad.exe

==&gt; 在远程机器 &quot;ABC&quot; 创建计划任务 &quot;logtracker&quot;， 每隔五分钟从指定的开始时间到无结束时间， 运行 notepad.exe。将提示输入 /RP 密码。

SCHTASKS /Create /S ABC /U domain\user /P password /SC MINUTE
/MO 5 /TN logtracker
/TR c:\windows\system32\notepad.exe /ST 18:30
/RU runasuser /RP

==&gt; 创建计划任务 &quot;gaming&quot;，每天从 12:00 点开始到 14:00 点自动结束，运行 freecell.exe。

SCHTASKS /Create /SC DAILY /TN gaming /TR c:\freecell /ST 12:00
/ET 14:00 /K

==&gt; 创建计划任务“EventLog”以开始运行 wevtvwr.msc 只要在“系统”通道中发布事件 101

SCHTASKS /Create /TN EventLog /TR wevtvwr.msc /SC ONEVENT
/EC System /MO *[System/EventID=101]

==&gt; 文件路径中可以加入空格，但需要加上两组引号， 一组引号用于 CMD.EXE，另一组用于 SchTasks.exe。用于 CMD 的外部引号必须是一对双引号；内部引号可以是一对单引号或 一对转义双引号:

SCHTASKS /Create
/tr &quot;&#39;c:\program files\internet explorer\iexplorer.exe&#39;
\&quot;c:\log data\today.xml\&quot;&quot; ...
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id24">公用头</a><a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<div class="highlight-org notranslate" id="bat-header"><div class="highlight"><pre><span></span>@echo off
chcp 65001
</pre></div>
</div>
</div>
<div class="section" id="notepad">
<h3><a class="toc-backref" href="#id25">某个时间打开notepad</a><a class="headerlink" href="#notepad" title="永久链接至标题">¶</a></h3>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="p">@</span><span class="k">echo</span> off
chcp 65001
SCHTASKS /create /tn <span class="s2">&quot;一分钟后打开notepad&quot;</span> /sc DAILY /ST 10:56 /TR notepad.exe
</pre></div>
</div>
</div>
<div class="section" id="s1">
<h3><a class="toc-backref" href="#id26">每2S运行1个任务</a><a class="headerlink" href="#s1" title="永久链接至标题">¶</a></h3>
<div class="highlight-bat notranslate" id="create-task"><div class="highlight"><pre><span></span><span class="p">@</span><span class="k">echo</span> off
chcp 65001
SCHTASKS /Create /tn <span class="s2">&quot;一分钟后打开notepad&quot;</span> /sc MINUTE /MO 1 /TR notepad
<span class="p">:</span><span class="c1">: SCHTASKs /Create /tn &quot;一分钟后打开notepad&quot; /sc once /st 18:39 /tr notepad /f</span>
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">$i</span> <span class="o">=</span> <span class="m">0</span>
<span class="k">for</span> <span class="o">(</span><span class="nv">$i</span><span class="o">=</span><span class="m">0</span><span class="p">;</span> <span class="nv">$i</span> -le <span class="m">4</span><span class="p">;</span> <span class="nv">$i</span>++<span class="o">)</span> <span class="o">{</span>
    <span class="nv">$time</span><span class="o">=</span><span class="nv">$i</span> + <span class="m">1</span>
    Write-Host <span class="s1">&#39;Now running&#39;</span>,<span class="nv">$time</span>,<span class="s1">&#39;times!&#39;</span><span class="p">;</span>
    Start-Process <span class="s2">&quot;cmd.exe&quot;</span> <span class="s2">&quot;/c F:\files\soul\code\run-notepad.bat&quot;</span>
    sleep <span class="m">2</span>
    <span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>powershell -file powershell/every-10-second-run-script.ps1
</pre></div>
</div>
<div class="section" id="id5">
<h4><a class="toc-backref" href="#id27">问题和解决方式</a><a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h4>
<p>问题是schtasks不具备秒级运行的能力.需要借助powershell来实现。</p>
<p>一种方法是，利用 Windows 任务计划程序，设置6个触发器。</p>
</div>
</div>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id28">中止计划</a><a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<div class="highlight-org notranslate"><div class="highlight"><pre><span></span>schtasks /End /tn &quot;一分钟后打开notepad&quot;
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id29">删除任务</a><a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>schtasks /delete /tn <span class="s2">&quot;一分钟后打开notepad&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id30">按照某段时间查询计划</a><a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<p>/NH 选项仅对Table,CSV有效，目的是干掉表头</p>
<div class="section" id="id9">
<h4><a class="toc-backref" href="#id31">打印为列表</a><a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h4>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>SCHTASKS /Query /FO list /tn <span class="s2">&quot;一分钟后运行notepad&quot;</span> /V
</pre></div>
</div>
<div class="highlight-org notranslate"><div class="highlight"><pre><span></span>Folder: \
HostName:                             REVOLT
TaskName:                             \一分钟后运行notepad
Next Run Time:                        8/1/2021 4:04:00 PM
Status:                               Ready
Logon Mode:                           Interactive only
Last Run Time:                        8/1/2021 4:03:01 PM
Last Result:                          0
Author:                               REVOLT\admin
Task To Run:                          notepad.exe
Start In:                             N/A
Comment:                              N/A
Scheduled Task State:                 Enabled
Idle Time:                            Disabled
Power Management:                     Stop On Battery Mode, No Start On Batteries
Run As User:                          admin
Delete Task If Not Rescheduled:       Disabled
Stop Task If Runs X Hours and X Mins: 72:00:00
Schedule:                             Scheduling data is not available in this format.
Schedule Type:                        One Time Only, Minute
Start Time:                           3:51:00 PM
Start Date:                           8/1/2021
End Date:                             N/A
Days:                                 N/A
Months:                               N/A
Repeat: Every:                        0 Hour(s), 1 Minute(s)
Repeat: Until: Time:                  None
Repeat: Until: Duration:              Disabled
Repeat: Stop If Still Running:        Disabled
</pre></div>
</div>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>SCHTASKS /Query /FO list /tn <span class="s2">&quot;一分钟后运行notepad&quot;</span>
</pre></div>
</div>
<p>SCHTASKS /Query /FO LIST /NH /V /tn “一分钟后运行notepad”</p>
<p>SCHTASKS /query /tn “一分钟后运行notepad”</p>
</div>
<div class="section" id="id10">
<h4><a class="toc-backref" href="#id32">查询</a><a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h4>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>schtasks /query /v /fo list /tn <span class="s2">&quot;一分钟后运行notepad&quot;</span>
</pre></div>
</div>
<p>Emacs 集成环境设置</p>
</div>
</div>
</div>
<div class="section" id="emacs-batch">
<h2><a class="toc-backref" href="#id33">Emacs Batch 集成环境设置</a><a class="headerlink" href="#emacs-batch" title="永久链接至标题">¶</a></h2>
<p>如果你篡改了 <code class="docutils literal notranslate"><span class="pre">%HOME%</span></code> 变量,Emacs默认加载的文件路径会发生变化! 所以还是
不要轻易的J2变动.</p>
<div class="section" id="cmd">
<h3><a class="toc-backref" href="#id34">直接绑定 CMD 固定目录终端</a><a class="headerlink" href="#cmd" title="永久链接至标题">¶</a></h3>
<div class="highlight-elisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">defun</span> <span class="nv">start-cmd</span> <span class="p">()</span>
  <span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">proc</span>
     <span class="p">(</span><span class="nf">start-process</span> <span class="s">&quot;cmd&quot;</span> <span class="no">nil</span> <span class="s">&quot;cmd.exe&quot;</span> <span class="s">&quot;/C&quot;</span> <span class="s">&quot;start&quot;</span> <span class="s">&quot;cmd.exe&quot;</span> <span class="s">&quot;/K&quot;</span> <span class="s">&quot;cd /D&quot;</span> <span class="s">&quot;c:/Users/admin/Desktop/html/sphinx-blog/docs/&quot;</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">set-process-query-on-exit-flag</span> <span class="nv">proc</span> <span class="no">nil</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h3><a class="toc-backref" href="#id35">有用的环境变量</a><a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> %USERPROFILE%
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h3><a class="toc-backref" href="#id36">设置永久变量</a><a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>setx HOME %USERPROFILE%
<span class="nb">echo</span> %HOME%
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h3><a class="toc-backref" href="#id37">追加路径</a><a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h3>
<p>TODO</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> %PATH%
</pre></div>
</div>
<div class="section" id="id14">
<h4><a class="toc-backref" href="#id38">将某个目录添加环境变量中</a><a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h4>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>setx path <span class="s2">&quot;D:\bug.n;%PATH%&quot;</span>
</pre></div>
</div>
<p>setx 会遇到1024个字符的限制</p>
<ul class="simple">
<li><p><a class="reference external" href="https://superuser.com/questions/387619/overcoming-the-1024-character-limit-with-setx">https://superuser.com/questions/387619/overcoming-the-1024-character-limit-with-setx</a></p></li>
</ul>
<p>Powershell的解决方式</p>
<ul class="simple">
<li><p><a class="reference external" href="https://blog.csdn.net/Redboy_Crazy/article/details/104120093">https://blog.csdn.net/Redboy_Crazy/article/details/104120093</a></p></li>
</ul>
</div>
</div>
<div class="section" id="id15">
<h3><a class="toc-backref" href="#id39">不打开文件或用户对话框</a><a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h3>
<div class="highlight-elisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">setq</span> <span class="nv">use-file-dialog</span> <span class="no">nil</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">use-dialog-box</span> <span class="no">nil</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h3><a class="toc-backref" href="#id40">追加环境变量</a><a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<div class="highlight-elisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">setenv</span> <span class="s">&quot;PATH&quot;</span>
    <span class="p">(</span><span class="nf">concat</span> <span class="s">&quot;D:\\sqlite&quot;</span> <span class="s">&quot;;&quot;</span>
            <span class="p">(</span><span class="nv">getenv</span> <span class="s">&quot;PATH&quot;</span><span class="p">)</span>
            <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h3><a class="toc-backref" href="#id41">查找文件</a><a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h3>
<div class="highlight-elisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">find-file</span> <span class="nv">~/.emacs.d/init.el</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h3><a class="toc-backref" href="#id42">异步执行命令</a><a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h3>
<div class="highlight-elisp notranslate"><div class="highlight"><pre><span></span><span class="nv">notepad.exe</span> <span class="nv">&amp;</span>
</pre></div>
</div>
</div>
<div class="section" id="id19">
<h3><a class="toc-backref" href="#id43">复制命令输出至剪切板</a><a class="headerlink" href="#id19" title="永久链接至标题">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>systeminfo <span class="p">|</span> clip
</pre></div>
</div>
</div>
<div class="section" id="cmd-eshell">
<h3><a class="toc-backref" href="#id44">Cmd 命令和 Eshell 命令混合使用</a><a class="headerlink" href="#cmd-eshell" title="永久链接至标题">¶</a></h3>
<p>在 Eshell 中可以混合使用:</p>
<div class="highlight-eshell notranslate"><div class="highlight"><pre><span></span>split-string $PATH &quot;;&quot;
</pre></div>
</div>
<div class="highlight-eshell notranslate"><div class="highlight"><pre><span></span>for m in {split-string $PATH &quot;;&quot;} {echo $m}
</pre></div>
</div>
<div class="highlight-eshell notranslate"><div class="highlight"><pre><span></span>for m in $load-path { echo $m}
</pre></div>
</div>
</div>
<div class="section" id="powershell">
<h3><a class="toc-backref" href="#id45">直接运行 PowerShell 终端</a><a class="headerlink" href="#powershell" title="永久链接至标题">¶</a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">defun</span> <span class="n">run-powershell</span> <span class="p">()</span>
 <span class="s2">&quot;Run powershell&quot;</span>
 <span class="p">(</span><span class="n">interactive</span><span class="p">)</span>
 <span class="p">(</span><span class="n">async-shell-command</span> <span class="s2">&quot;c:/windows/system32/WindowsPowerShell/v1.0/powershell.exe -Command -&quot;</span>
  <span class="n">nil</span>
  <span class="n">nil</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="bat">
<h3><a class="toc-backref" href="#id46">Bat 示例</a><a class="headerlink" href="#bat" title="永久链接至标题">¶</a></h3>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="p">@</span><span class="k">echo</span> off
<span class="c1">rem  Compile for x86 or x64 bits</span>
<span class="c1">rem ------------------------------</span>
<span class="k">set</span> <span class="nv">MODE</span><span class="p">=</span>x86
<span class="c1">rem set MODE=x64</span>
<span class="p">@</span><span class="c1">REM Visual studio building tools path - Install it with chocolately</span>
<span class="k">set</span> <span class="nv">VS2017</span><span class="p">=</span><span class="s2">&quot;C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvarsamd64_x86.bat&quot;</span>
<span class="k">set</span> <span class="nv">VS2015</span><span class="p">=</span><span class="s2">&quot;C:\Program Files (x86)\Microsoft Visual C++ Build Tools\vcbuildtools.bat&quot;</span>
<span class="c1">rem Save current directory</span>
<span class="k">pushd</span> <span class="nv">%CD%</span>
<span class="p">@</span><span class="c1">REM Set visual Studio 2017</span>
<span class="k">call</span> <span class="nv">%VS2017%</span> <span class="nv">%MODE%</span>
<span class="p">@</span><span class="c1">REM Restore saved directory</span>
<span class="k">popd</span>
<span class="p">@</span><span class="c1">REM ------------------ User Command Goes Here ----------------- @REM</span>
<span class="p">@</span><span class="c1">REM Build solution in Debug mode</span>
cl.exe  test.cpp <span class="p">&amp;&amp;</span> test.exe
<span class="p">@</span><span class="c1">REM Set /p Wait=Build Process Completed...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id20">
<h2><a class="toc-backref" href="#id47">记录错误级别日志</a><a class="headerlink" href="#id20" title="永久链接至标题">¶</a></h2>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">ECHO</span> error level is <span class="nv">%ERRORLEVEL%</span> <span class="p">&gt;</span> logfile <span class="p">&amp;</span> <span class="k">type</span> logfile
</pre></div>
</div>
</div>
</div>


              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="init-batch-mode.html" title="previous page">Batch Script</a>
    <a class='right-next' id="next-link" href="init-batch-mode-three.html" title="next page">Batch Script</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Revolt<br/>
        
            &copy; Copyright 2021, Revolt.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>